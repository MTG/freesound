{% extends "monitor/base.html" %}

{% load static %}
{% load bw_templatetags %}

{% block title %}Monitor - Stats{% endblock %}

{% block main_content %}

<h1>Stats</h1>

<h2 id="global-stats" class="v-spacing-top-5 v-spacing-2">Global numbers
    <a class="headerlink" href="#global-stats" title="Permalink to this headline">¶</a>
</h2>
<div class="bw-wiki">
    <table>
        <tr>
            <td><b>Active Users:</b></td><td id="total-users"></td>
            <td><b>Comments:</b> </td><td id="total-comments"></td>
            <td><b>Avg tags per sound:</b> </td><td id="avg-tags"></td>
        </tr>
        <tr>
            <td><b>Uploaders:</b></td><td id="users-with-sounds"></td>
            <td><b>Avg comments per sound:</b> </td><td id="avg-comments"></td>
            <td><b>Posts:</b> </td><td id="total-posts"></td>
        </tr>
        <tr>
            <td><b>Sounds:</b> </td><td id="total-sounds"></td>
            <td><b>Ratings:</b> </td><td id="total-ratings"></td>
            <td><b>Threads:</b> </td><td id="total-threads"></td>
        </tr>
        <tr>
            <td><b>Packs:</b> </td><td id="total-packs"></td>
            <td><b>Avg ratings per sound:</b> </td><td id="avg-ratings"></td>
            <td><b>Donations:</b> </td><td id="total-donations"></td>
        </tr>
        <tr>
            <td><b>Downloads:</b> </td><td id="total-downloads"></td>
            <td><b>Unique tags:</b> </td><td id="total-tags"></td>
            <td><b>Donations by year (estimated with last 30 days data):</b></td><td id="proj-donations"></td>
        </tr>
        <tr>
            <td><b>Avg downloads per sound:</b> </td><td id="avg-downloads"></td>
            <td><b>Tags applications:</b> </td><td id="total-used-tags"></td>
            <td></td><td></td>
        </tr>
    </table>
    
    
</div>

<h2 id="users-stats" class="v-spacing-top-5">Users
    <a class="headerlink" href="#users-stats" title="Permalink to this headline">¶</a>
</h2>
<h3>Registered users in last two weeks</h3>
<div class='users'>
</div>

<h3>Active users by activity per week</h3>
<div class='active-users'>
</div>

<h2 id="sounds-stats" class="v-spacing-top-5">Sounds
    <a class="headerlink" href="#sounds-stats" title="Permalink to this headline">¶</a>
</h2>
<h3>Sounds created in last two weeks</h3>
<div class='uploads'>
</div>

<h2 id="downloads-stats" class="v-spacing-top-5">Downloads
    <a class="headerlink" href="#downloads-stats" title="Permalink to this headline">¶</a>
</h2>
<h3>Downloads in last two weeks</h3>
<div class='downloads'>
</div>

<h2 id="year-donations" class="v-spacing-top-5">Donations
    <a class="headerlink" href="#year-donations" title="Permalink to this headline">¶</a>
</h2>
<h3>Donations in the last 12 months</h3>
<div class='donations'>
</div>

<div style="display:inline-block">
    <h2 id="tags-stats" class="v-spacing-top-5">Tags
        <a class="headerlink" href="#tags-stats" title="Permalink to this headline">¶</a>
    </h2>
    <h3>Most used tags in last two weeks</h3>
    <canvas id='tags-cloud-week' width=450 height=450>
    </canvas>
</div>

<div style="display:inline-block">
    <h3>Tag cloud with most downlaoded tags in last two weeks</h3>
    <canvas id='down-tags-cloud' width=450 height=450>
    </canvas>
</div>

<h3>Tag cloud with most used tags</h3>
<canvas id='tags-cloud' width=600 height=600>
</canvas>


<h2 id="user-queries-stats" class="v-spacing-top-5">User Queries
    <a class="headerlink" href="#user-queries-stats" title="Permalink to this headline">¶</a>
</h2>
<h3>Most common queries in last two weeks</h3>
<canvas id='queries-wordcloud' width=600 height=600>
</canvas>

<script>
    var totalsDataUrl = '{% url 'monitor-totals-stats-ajax' %}';
    var queriesDataUrl = '{% url 'monitor-queries-stats-ajax' %}';
    var tagsDataUrl = '{% url 'monitor-tags-stats-ajax' %}';
    var downloadsDataUrl = '{% url 'monitor-downloads-stats-ajax' %}';
    var donationsDataUrl = '{% url 'monitor-donations-stats-ajax' %}';
    var soundsDataUrl = '{% url 'monitor-sounds-stats-ajax' %}';
    var usersDataUrl = '{% url 'monitor-users-stats-ajax' %}';
    var activeUsersDataUrl = '{% url 'monitor-active-users-stats-ajax' %}';
</script>
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://d3js.org/d3.v4.min.js" type="text/javascript"></script>
<script src="https://d3js.org/d3-axis.v1.min.js"></script>
<script src="https://d3js.org/d3-array.v1.min.js"></script>
<script src="https://d3js.org/d3-collection.v1.min.js"></script>
<script src="https://d3js.org/d3-color.v1.min.js"></script>
<script src="https://d3js.org/d3-format.v1.min.js"></script>
<script src="https://d3js.org/d3-interpolate.v1.min.js"></script>
<script src="https://d3js.org/d3-time.v1.min.js"></script>
<script src="https://d3js.org/d3-time-format.v2.min.js"></script>
<script src="https://d3js.org/d3-scale.v1.min.js"></script>
<script src="https://d3js.org/d3-path.v1.min.js"></script>
<script src="https://d3js.org/d3-shape.v1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/wordcloud2.js/1.0.2/wordcloud2.min.js"></script>
{% endblock %}
